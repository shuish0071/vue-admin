{"remainingRequest":"D:\\Program Files\\python_project\\vue\\vue4-admin\\node_modules\\babel-loader\\lib\\index.js!D:\\Program Files\\python_project\\vue\\vue4-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Program Files\\python_project\\vue\\vue4-admin\\src\\router\\permit.js","dependencies":[{"path":"D:\\Program Files\\python_project\\vue\\vue4-admin\\src\\router\\permit.js","mtime":1592746730376},{"path":"D:\\Program Files\\python_project\\vue\\vue4-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Program Files\\python_project\\vue\\vue4-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\Program Files\\python_project\\vue\\vue4-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgcm91dGVyIGZyb20gIkAvcm91dGVyL2luZGV4IjsKaW1wb3J0IHsgZ2V0VG9rZW4sIHJlbW92ZVRva2VuLCByZW1vdmVVc2VybmFtZSB9IGZyb20gIkAvdXRpbHMvYXBwIjsKaW1wb3J0IHN0b3JlIGZyb20gIkAvc3RvcmUiOyAvLyBpbmRleE9mKCkg5pa55rOV5Yik5pat5pWw57uE5Lit5piv5ZCm5a2Y5Zyo5oyH5a6a55qE5a+56LGhLOS4jeWtmOWcqOWImei/lOWbni0xCgp2YXIgd2hpdGVSb3V0ZXIgPSBbIi9sb2dpbiJdOyAvLyDot6/nlLHlrojljasKCnJvdXRlci5iZWZvcmVFYWNoKGZ1bmN0aW9uICh0bywgZnJvbSwgbmV4dCkgewogIGlmIChnZXRUb2tlbigpKSB7CiAgICAvLyDnrKzkuozmrKHot6/nlLHot7PovazliLBsb2dpbu+8jOinhuS4umxvZ291dO+8jGNvb2tpZeWSjHZ1ZXjpg73liKDpmaR0b2tlbuOAgXVzZXJuYW1lCiAgICBpZiAodG8ucGF0aCA9PT0gIi9sb2dpbiIpIHsKICAgICAgLy8gY29uc29sZS5sb2coc3RvcmUuc3RhdGUuYXBwLnVzZXJuYW1lKTsKICAgICAgLy8gY29uc29sZS5sb2coc3RvcmUuc3RhdGUuYXBwLnRva2VuKTsKICAgICAgcmVtb3ZlVG9rZW4oKTsKICAgICAgcmVtb3ZlVXNlcm5hbWUoKTsKICAgICAgc3RvcmUuY29tbWl0KCJhcHAvU0VUX1RPS0VOIiwgIiIpOwogICAgICBzdG9yZS5jb21taXQoImFwcC9TRVRfVVNFUk5BTUUiLCAiIik7CiAgICAgIG5leHQoKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOiOt+WPluinkuiJsu+8jOWKqOaAgeWIhumFjei3r+eUseadg+mZkAogICAgICBuZXh0KCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmICh3aGl0ZVJvdXRlci5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICBuZXh0KCk7CiAgICB9IGVsc2UgewogICAgICBuZXh0KCIvbG9naW4iKTsKICAgIH0KICB9Cn0pOw=="},{"version":3,"sources":["D:/Program Files/python_project/vue/vue4-admin/src/router/permit.js"],"names":["router","getToken","removeToken","removeUsername","store","whiteRouter","beforeEach","to","from","next","path","commit","indexOf"],"mappings":";AAAA,OAAOA,MAAP,MAAmB,gBAAnB;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,cAAhC,QAAsD,aAAtD;AACA,OAAOC,KAAP,MAAkB,SAAlB,C,CAEA;;AACA,IAAMC,WAAW,GAAG,CAAC,QAAD,CAApB,C,CAEA;;AACAL,MAAM,CAACM,UAAP,CAAkB,UAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACpC,MAAIR,QAAQ,EAAZ,EAAgB;AACd;AACA,QAAIM,EAAE,CAACG,IAAH,KAAY,QAAhB,EAA0B;AACxB;AACA;AACAR,MAAAA,WAAW;AACXC,MAAAA,cAAc;AACdC,MAAAA,KAAK,CAACO,MAAN,CAAa,eAAb,EAA8B,EAA9B;AACAP,MAAAA,KAAK,CAACO,MAAN,CAAa,kBAAb,EAAiC,EAAjC;AACAF,MAAAA,IAAI;AACL,KARD,MAQO;AACL;AACAA,MAAAA,IAAI;AACL;AACF,GAdD,MAcO;AACL,QAAIJ,WAAW,CAACO,OAAZ,CAAoBL,EAAE,CAACG,IAAvB,MAAiC,CAAC,CAAtC,EAAyC;AACvCD,MAAAA,IAAI;AACL,KAFD,MAEO;AACLA,MAAAA,IAAI,CAAC,QAAD,CAAJ;AACD;AACF;AACF,CAtBD","sourcesContent":["import router from \"@/router/index\";\r\nimport { getToken, removeToken, removeUsername } from \"@/utils/app\";\r\nimport store from \"@/store\";\r\n\r\n// indexOf() 方法判断数组中是否存在指定的对象,不存在则返回-1\r\nconst whiteRouter = [\"/login\"];\r\n\r\n// 路由守卫\r\nrouter.beforeEach((to, from, next) => {\r\n  if (getToken()) {\r\n    // 第二次路由跳转到login，视为logout，cookie和vuex都删除token、username\r\n    if (to.path === \"/login\") {\r\n      // console.log(store.state.app.username);\r\n      // console.log(store.state.app.token);\r\n      removeToken();\r\n      removeUsername();\r\n      store.commit(\"app/SET_TOKEN\", \"\");\r\n      store.commit(\"app/SET_USERNAME\", \"\");\r\n      next();\r\n    } else {\r\n      // 获取角色，动态分配路由权限\r\n      next();\r\n    }\r\n  } else {\r\n    if (whiteRouter.indexOf(to.path) !== -1) {\r\n      next();\r\n    } else {\r\n      next(\"/login\");\r\n    }\r\n  }\r\n});\r\n"]}]}